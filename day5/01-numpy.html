
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Working with Numpy Arrays &#8212; UC Berkeley Chem 280  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=4974aa07" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'day5/01-numpy';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/msse_logo.svg" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/msse_logo.svg" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">UC Berkeley MSSE - Chem 280</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../setup.html">
    Computer Set-Up
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://msse.berkeley.edu/">
    MSSE
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/msse-chem-280-2024/msse-chem-280-2024.github.io" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/MolSSI_NSF" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../setup.html">
    Computer Set-Up
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://msse.berkeley.edu/">
    MSSE
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/msse-chem-280-2024/msse-chem-280-2024.github.io" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/MolSSI_NSF" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Working...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="working-with-numpy-arrays">
<h1>Working with Numpy Arrays<a class="headerlink" href="#working-with-numpy-arrays" title="Link to this heading">#</a></h1>
<div class="overview admonition">
<p class="admonition-title">Overview</p>
<p>Questions:</p>
<ul class="simple">
<li><p>What are the differences between NumPy arrays and lists?</p></li>
<li><p>How can I use NumPy to do calculations?</p></li>
</ul>
<p>Objectives:</p>
<ul class="simple">
<li><p>Be able to name the differences between Python lists and numpy arrays.</p></li>
<li><p>Understand the idea of broadcasting.</p></li>
</ul>
</div>
<p><a class="reference external" href="https://numpy.org/">Numpy</a> is a widely used Python library for scientific computing. It has a number of useful features, including the a data structure called an array. Compared to the built-in data types <code class="docutils literal notranslate"><span class="pre">lists</span></code> which we used previously, <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays have many features which can help you in your data analysis. Properly using the features of numpy arrays will make your code much faster and more efficient.</p>
<section id="numpy-arrays-vs-python-lists">
<h2>NumPy Arrays vs. Python Lists<a class="headerlink" href="#numpy-arrays-vs-python-lists" title="Link to this heading">#</a></h2>
<p>Previously, you have worked with the built-in types of <code class="docutils literal notranslate"><span class="pre">lists</span></code>. NumPy arrays seem similar, but offer some distinct advantages.</p>
<p>First open a Jupyter notebook to record your work.</p>
<p>To use the numpy library, we have to import it. When <code class="docutils literal notranslate"><span class="pre">numpy</span></code> is imported, it is often shortened to <code class="docutils literal notranslate"><span class="pre">np</span></code>. Define a system of three atoms as we have been using in many of our test cases:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-0">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span> 

<span class="c1"># Construct some coordinates</span>
<span class="n">coordinates</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)],</span> 
              <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)],</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>

<span class="n">second_coordinate</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now that we have our second coordinate, let’s imagine we wanted to do something to it. Let’s imagine that we wanted to translate the position of the atom (much like we do in our Monte Carlo simulation!). We want to translate it 0.1 units in the x direction, -0.1 units in the y direction, and 0 units in the z direction.</p>
<p>Using the Python Standard Library as we have learned so far, we could write code for this translation:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-1" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-1">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">translation_vector</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">new_coordinate</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">translated_coordinate</span> <span class="o">=</span> <span class="n">second_coordinate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">translation_vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">new_coordinate</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">translated_coordinate</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">new_coordinate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-2">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[0.1, -0.1, 1.122462048309373]</span>
</pre></div>
</div>
</div>
</div>
<p>In our code so far, we have written a lot of <code class="docutils literal notranslate"><span class="pre">for</span></code> loops. Use of NumPy, however, will allow us to avoid loops in many cases. Let’s consider how we could perform our translation with NumPy instead. One way numpy arrays and lists are different is that you can easily perform element-wise operations on numpy arrays without using <code class="docutils literal notranslate"><span class="pre">for</span></code> loops. You can make your code much faster if you use numpy element-by-element operations instead of loops.</p>
<p>If an operation is performed with two arrays (or a list and an array), NumPy will guess that you want to do element-wise addition. In the code we just wrote, we actually wanted an answer that looked like</p>
<div class="math notranslate nohighlight">
\[
(x_1 + x_2, y_1+ y_2, z_1+z_2)
\]</div>
<p>where <code class="docutils literal notranslate"><span class="pre">second_atom</span> <span class="pre">=</span> <span class="pre">[x1,</span> <span class="pre">y1,</span> <span class="pre">z1]</span></code>, and <code class="docutils literal notranslate"><span class="pre">translation_vector</span> <span class="pre">=</span> <span class="pre">[x2,</span> <span class="pre">y2,</span> <span class="pre">z2]</span></code>. In other words, we added elememts with the same index together (or did the operation “element-wise”). You will also notice that in the <code class="docutils literal notranslate"><span class="pre">for</span></code> loop we wrote, we were using the same index <code class="docutils literal notranslate"><span class="pre">i</span></code> for both lists we were indexing into. Because of this, we can <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays to more easily perform this calculation.</p>
<p>Let’s see how we would do the same operation as before using NumPy arrays. To cast a list as a numpy array, you use <code class="docutils literal notranslate"><span class="pre">np.array(list_name)</span></code>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-3" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-3">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Create numpy array from list</span>
<span class="n">second_coordinate_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">second_coordinate</span><span class="p">)</span>

<span class="c1"># Create a numpy array from list</span>
<span class="n">translation_vector_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">translation_vector</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Using the features of numpy arrays, we could have instead written the following instead of the original <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-4">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_coordinate_np</span> <span class="o">=</span> <span class="n">second_coordinate_np</span> <span class="o">+</span> <span class="n">translation_vector_np</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new_coordinate_np</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-5" name="sd-tab-set-5" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-5">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[ 0.1        -0.1         1.12246205]</span>
</pre></div>
</div>
</div>
</div>
<p>NumPy performed the addition operation on these two arrays in an element-wise fashion. The shape of both lists was compared, and because they were the same shape, element-wise operation was used. You could have also subtracted, multiplied, or divided these, and it would have performed element-wise operations.</p>
<p>Note that this only worked because at least one of these variables was a NumPy array.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-6" name="sd-tab-set-6" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-6">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">second_coordinate_np</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-7" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-7">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">numpy.ndarray</span>
</pre></div>
</div>
</div>
</div>
<p>What happens if we try this were both variables are a list?</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-8" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-8">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">second_coordinate</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-9" name="sd-tab-set-9" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-9">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">list</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-10" name="sd-tab-set-10" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-10">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Adding two lists results in list concatenation</span>
<span class="n">second_coordinate</span> <span class="o">+</span> <span class="n">translation_vector</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-11" name="sd-tab-set-11" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-11">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[0, 0, 1.122462048309373, 0.1, -0.1, 0]</span>
</pre></div>
</div>
</div>
</div>
<p>When you use the <code class="docutils literal notranslate"><span class="pre">+</span></code> with two lists, it results in list concatenation, or the second list being appended to the end of the first. Element-wise operation is not possible on standard Python lists. You must use <code class="docutils literal notranslate"><span class="pre">for</span></code> loops to iterature through them.</p>
<div class="tip admonition">
<p class="admonition-title">Concatenating arrays</p>
<p>If you wanted to concatenate the two numpy arrays, you could have done so with the <code class="docutils literal notranslate"><span class="pre">np.concatenate</span></code> function.</p>
<p>Addition of two lists results in concatenation of the lists
Addition of to numpy arrays results in elements wise addition if possible</p>
</div>
<p>Element wise operations work with multiplication and division as well.</p>
<div class="exercise admonition">
<p class="admonition-title">Check your understanding</p>
<p>Consider the definitions for <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">a2</span></code>.
What does each print statement result in?</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-12" name="sd-tab-set-12" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-12">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a1</span> <span class="o">*</span> <span class="n">a2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The code block results in the following output</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-13" name="sd-tab-set-13" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-13">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[2 3 0]</span>
<span class="go">[3 4 5]</span>
</pre></div>
</div>
</div>
</div>
<p>For the first line, the first element is <code class="docutils literal notranslate"><span class="pre">a1[0]*a2[0]</span></code>, the second element is <code class="docutils literal notranslate"><span class="pre">a1[1]*a2[1]</span></code>, and the third element is <code class="docutils literal notranslate"><span class="pre">a1[2]*a2[2]</span></code>.
For the second line, the first element is <code class="docutils literal notranslate"><span class="pre">a1[0]+a2[0]</span></code>, second is <code class="docutils literal notranslate"><span class="pre">a1[1]+a2[1]</span></code>, third is <code class="docutils literal notranslate"><span class="pre">a1[2]+a2[2]</span></code>.</p>
</div>
</div>
<div class="exercise admonition">
<p class="admonition-title">Check your understanding</p>
<p>Consider the definitions for <code class="docutils literal notranslate"><span class="pre">a1</span></code> and <code class="docutils literal notranslate"><span class="pre">a2</span></code>.
What does each print statement restult in?</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-14" name="sd-tab-set-14" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-14">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">a2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">a1</span> <span class="o">*</span> <span class="n">a2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a1</span> <span class="o">+</span> <span class="n">a2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>The first print statement results in concatenation of the lists.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-15" name="sd-tab-set-15" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-15">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[2, 1, 0, 1, 3, 5]</span>
</pre></div>
</div>
</div>
</div>
<p>The second print statement results in a <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>. This is because two lists cannot be multiplied. If you wanted to do element-wise multiplication, you would have to use <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays (like in the previous exercise.)</p>
</div>
</div>
</section>
<section id="array-shape">
<h2>Array Shape<a class="headerlink" href="#array-shape" title="Link to this heading">#</a></h2>
<p>The two arrays have to have compatible dimensions in order to be added. For example, if we try to add an array with two elements to an array of three elements, we will get an error.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-16" name="sd-tab-set-16" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-16">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
<span class="n">second_coordinate</span> <span class="o">+</span> <span class="n">my_array</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-17" name="sd-tab-set-17" type="radio">
<label class="sd-tab-label" for="sd-tab-item-17">
error</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">ValueError</span><span class="p">:</span> <span class="n">operands</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">be</span> <span class="n">broadcast</span> <span class="n">together</span> <span class="k">with</span> <span class="n">shapes</span> <span class="p">(</span><span class="mi">3</span><span class="p">,)</span> <span class="p">(</span><span class="mi">2</span><span class="p">,)</span> 
</pre></div>
</div>
</div>
</div>
<p>This is because the two arrays have incompatible sizes. You can see the size of the array by using the command:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-18" name="sd-tab-set-18" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-18">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">array_name</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>For example, we can check the size of <code class="docutils literal notranslate"><span class="pre">second_coordinate_np</span></code>:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-19" name="sd-tab-set-19" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-19">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">second_coordinate_np</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>We can convert our coordinates to a NumPy array and print the shape</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-20" name="sd-tab-set-20" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-20">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coordinates_np</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Though hard to see from our example, when the shape of a NumPy array is given, the first number is the number of rows and the second number is the number of columns. When we use <code class="docutils literal notranslate"><span class="pre">coordinates_np.shape</span></code> it tells us <code class="docutils literal notranslate"><span class="pre">(4,3)</span></code>. This means we have 4 rows and 3 columns (which is what we would expect for four atoms in three dimensions).</p>
<section id="accessing-information-in-a-multidimensional-array">
<h3>Accessing Information in a Multidimensional Array<a class="headerlink" href="#accessing-information-in-a-multidimensional-array" title="Link to this heading">#</a></h3>
<p>In the Python standard library, we have been representing coordinate information in a nested list. This required us to use two sets of brackets for indexing. For example, to get the x value of atom index 3 from our nested list (Python Standard library), we could do the following:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-21" name="sd-tab-set-21" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-21">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">atom_3</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="n">x_coord_atom_3</span> <span class="o">=</span> <span class="n">atom_3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x_coord_atom_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-22" name="sd-tab-set-22" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-22">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">1.122462048309373</span>
</pre></div>
</div>
</div>
</div>
<p>this could have been done in one line as well, note we have to use two sets of brackets:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-23" name="sd-tab-set-23" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-23">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-24" name="sd-tab-set-24" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-24">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mf">1.122462048309373</span>
</pre></div>
</div>
</div>
</div>
<p>When accessing information in a NumPy array, we can put the indices in one set of brackets. You put the row you would like first, followed by the column:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-25" name="sd-tab-set-25" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-25">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates_np</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="broadcasting">
<h2>Broadcasting<a class="headerlink" href="#broadcasting" title="Link to this heading">#</a></h2>
<p>However, in order for this type of operation to work, the arrays do not have to be <em>exactly</em> the same size they just have to have compatible shapes! Another special thing about numpy is something called <strong>broadcasting</strong>. Broadcasting occurs when you attempt mathematical operations on arrays that have different shapes. If possible, the smaller array is “broadcast” across the larger array.</p>
<p>Let’s think about what would happen if we wanted to move every atom in our coordinate set by our translation vector.</p>
<p>If you were working with Python lists, or you didn’t know about the features of numpy arrays, you might try to do this with a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-26" name="sd-tab-set-26" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-26">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">num_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<span class="n">new_coordinates</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">):</span>
    
    <span class="n">atom_coord</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">updated_coord</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">translated_coordinate</span> <span class="o">=</span> <span class="n">atom_coord</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">translation_vector</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">updated_coord</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">translated_coordinate</span><span class="p">)</span>
    
    <span class="n">new_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">updated_coord</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="n">new_coordinates</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-27" name="sd-tab-set-27" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-27">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[[0.1, -0.1, 0], [0.1, -0.1, 1.122462048309373], [0.1, -0.1, 2.244924096618746]]</span>
</pre></div>
</div>
</div>
</div>
<p>If we think about the indices we were adding the x indices together, the y indices together, and the z indices together for the two arrays. You might write something that looks like this to express the addition:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
c_{translated} = 
  \left[\begin{array}{rrr}
    c_{11} + t_1 &amp; c_{12} + t_2 &amp; c_{13} + t_3 \\
    c_{21} + t_1 &amp; c_{22} + t_2 &amp; c_{23} + t_3 \\
    c_{31} + t_1 &amp; c_{32} + t_2 &amp; c_{33} + t_3 \\
  \end{array}\right]
\end{split}\]</div>
<p>NumPy is able to compare the shape of two arrays to see if they are compatible. When we examine the shape, we see that they both have <code class="docutils literal notranslate"><span class="pre">3</span></code> present. The shapes are compatible.Broadcasting in <code class="docutils literal notranslate"><span class="pre">numpy</span></code> allows us to achieve that with one command, rather than in multiple <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-28" name="sd-tab-set-28" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-28">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_coordinates_np</span> <span class="o">=</span> <span class="n">coordinates_np</span> <span class="o">+</span> <span class="n">translation_vector_np</span>

<span class="nb">print</span><span class="p">(</span><span class="n">new_coordinates_np</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that both variables do not have to be arrays for this to work, only one. However, the two array-like variables do have to have a matching dimension. You can see the shape of an array using the function <code class="docutils literal notranslate"><span class="pre">np.shape</span></code>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-29" name="sd-tab-set-29" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-29">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-30" name="sd-tab-set-30" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-30">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">(3, 3)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-31" name="sd-tab-set-31" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-31">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">translation_vector_np</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-32" name="sd-tab-set-32" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-32">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">(3,)</span>
</pre></div>
</div>
</div>
</div>
<p>When you typed, <code class="docutils literal notranslate"><span class="pre">coordinates</span> <span class="pre">+</span> <span class="pre">translation_vector_np</span></code>, numpy looked at the shapes of both arrays to figure out if they were compatible.</p>
<p>If we are using a NumPy array for operations, this check will always be performed. You can also multiply arrays by scalars:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-33" name="sd-tab-set-33" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-33">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">10</span> <span class="o">*</span> <span class="n">coordinates_np</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="logical-comparisons">
<h2>Logical comparisons<a class="headerlink" href="#logical-comparisons" title="Link to this heading">#</a></h2>
<p>We can also do logical comparisons on whole arrays. For example, to find out if values in the array are greater than 0, we can write</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-34" name="sd-tab-set-34" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-34">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coordinates</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This will print either <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code> for each array element depending on whether the value of that element is greater than 0 or not.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-35" name="sd-tab-set-35" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-35">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">array([[False,  True, False],</span>
<span class="go">       [False, False,  True],</span>
<span class="go">       [False,  True,  True],</span>
<span class="go">       ...,</span>
<span class="go">       [False,  True,  True],</span>
<span class="go">       [ True,  True,  True],</span>
<span class="go">       [ True,  True,  True]])</span>
</pre></div>
</div>
</div>
</div>
<p>To get every value in the array that is greater than 0, we can use this as a list of indices we want, or a slice.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-36" name="sd-tab-set-36" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-36">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">greater_than_0_values</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">coordinates</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">greater_than_0_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-37" name="sd-tab-set-37" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-37">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[1.38509308 0.83913362 1.65106295 ... 3.49745584 0.37549254 4.39339869]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="array-axes">
<h2>Array Axes<a class="headerlink" href="#array-axes" title="Link to this heading">#</a></h2>
<p>Imagine we wanted to calculate the geometric center of our atoms To do this, we would need to get the average x coordinate, the average y coordinate, and the average z coordinate.</p>
<p>Previously, we would have done this with a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop and looped over the columns.
However, the <code class="docutils literal notranslate"><span class="pre">numpy.mean</span></code> function will let us do that without a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop.</p>
<p>To calculate the mean, or average of a set of data,</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-38" name="sd-tab-set-38" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-38">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates_np</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-39" name="sd-tab-set-39" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-39">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">0.3741540161031243</span>
</pre></div>
</div>
</div>
</div>
<p>When we use the mean function on an array without any other arguments, it will give us the average of all of the values.
However, sometimes, we prefer to have the average of all the rows or columns instead.
This ties into the idea of a NumPy array axis, a very important concept when working with NumPy.</p>
<p>Our NumPy array is an “n-dimensional” array.
The “n” indicates that we can have any number of dimensions, or axes.
We can see the number of axes or dimensions for our array using <code class="docutils literal notranslate"><span class="pre">.ndim</span></code></p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-40" name="sd-tab-set-40" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-40">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates_np</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-41" name="sd-tab-set-41" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-41">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">2</span>
</pre></div>
</div>
</div>
</div>
<p>Our NumPy array has two dimensions, or two axes.
This should make sense because we can use two numbers (row index and column index) to get the value of any cell in our NumPy array.</p>
<p>These axes are called “Axis 0” and “Axis 1”. Axis 0 is in the first position when indexing into an array, Axis 1 is the second.
The figure below shows an illustration of Axis 0 and Axis 1.
Axis 0 runs down the array, while Axis 1 goes across the columns.</p>
<img alt="../_images/numpy_array.svg" class="align-center" src="../_images/numpy_array.svg" />
<p>For most NumPy array operations, we can indicate which axis to apply the operation to.
<code class="docutils literal notranslate"><span class="pre">NumPy</span></code> functions usually allow us to specify this using the <code class="docutils literal notranslate"><span class="pre">axis</span></code> command.
When we specify <code class="docutils literal notranslate"><span class="pre">axis</span></code> we give an array axis over which to give an average.
In our two dimensional array, we choose between <code class="docutils literal notranslate"><span class="pre">axis=0</span></code> and <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>.
A key thing to realize is that when we do <code class="docutils literal notranslate"><span class="pre">axis=n</span></code>, it applies the operation down those axes.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-42" name="sd-tab-set-42" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-42">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">coordinates_np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coordinates_np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Notice that when we calculate the mean of axis=0, we get an output array with 4 values, while when we calculate the mean of axis=1, we get 3 values.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-43" name="sd-tab-set-43" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-43">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">[0.28061551 0.         0.84184654]</span>
<span class="go">[0.         0.37415402 0.74830803 0.37415402]</span>
</pre></div>
</div>
</div>
</div>
<p>Check the shape of our coordinates again:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-44" name="sd-tab-set-44" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-44">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates_np</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-45" name="sd-tab-set-45" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-45">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">(4, 3)</span>
</pre></div>
</div>
</div>
</div>
<p>If we want the column average (or the average of all the rows for a column), we would want the average value of our columns.
This corresponds to applying the operation down Axis 0.
When we examine the shape, we see that the have <code class="docutils literal notranslate"><span class="pre">4</span></code> values for each column (and this is indicated in the shape index = 1) We expect that we will have three values - the average x, the average y, and the average z.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-46" name="sd-tab-set-46" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-46">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>There are a lot of ways to think about array axes, and it will be beneficial to do a google search to find another explanation.</p>
</section>
<section id="additional-reading">
<h2>Additional Reading<a class="headerlink" href="#additional-reading" title="Link to this heading">#</a></h2>
<p>If you are still working to understand NumPy, try reading the <a class="reference external" href="https://numpy.org/doc/stable/user/absolute_beginners.html">Beginner’s Tutorial</a>.</p>
<div class="key admonition">
<p class="admonition-title">Key Points</p>
<ul class="simple">
<li><p>NumPy arrays which are the same size use element-wise operations when added or subtracted.</p></li>
<li><p>NumPy uses something called <em>broadcasting</em> for arrays which are not the same size to allow arrays to be added or multiplied.</p></li>
<li><p>NumPy has extensive documentation online - you should check this out if you need to do a computation.</p></li>
</ul>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numpy-arrays-vs-python-lists">NumPy Arrays vs. Python Lists</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-shape">Array Shape</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-information-in-a-multidimensional-array">Accessing Information in a Multidimensional Array</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#broadcasting">Broadcasting</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#logical-comparisons">Logical comparisons</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#array-axes">Array Axes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-reading">Additional Reading</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/day5/01-numpy.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  



  
  
  
  
  
  
  


<div class="row h-10">
    <div class="col-2">
        <a href="https://molssi.org/" target="_blank" title="Go to MolSSI in a new tab">
            <img src="../_static/molssi_main_logo.png" class="logo__image only-light footer_logo" alt="Logo image">
            <img src="../_static/molssi_main_logo_inverted_white.png" class="logo__image only-dark footer_logo" alt="Logo image">
        </a>
    </div>
    <div class="col-8">
        <p> &copy; Copyright 2019-2024 <a href="https://molssi.org/">The Molecular Sciences Software Institute</a></p>
        <p>Funded by the National Science Foundation 
          <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=1547580">OAC-1547580</a> and 
          <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2136142">CHE-2136142.</a></p>
 
        
        <p class="sphinx-version">
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.4.7.<br>
        </p>
        

        <p class="theme-version">
        Built with a customized <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
        </p>

    </div>
    <div class="col-2">
        <a href="https://nsf.gov/" target="_blank" title="Go to the NSF in a new tab">
            <img src="../_static/nsf.png" class="footer_logo" alt="The NSF">
          </a>
    </div>
</div></div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>