
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Lennard Jones Energy of Atomic System &#8212; UC Berkeley Chem 280  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=a3da09ef" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'day3/01-LJ-system';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cut-offs and Periodic Boundaries" href="02-computational-tricks.html" />
    <link rel="prev" title="Python Warm Up &amp; Returning to the LJ Equation" href="00-group-meeting.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/msse_logo.svg" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../_static/msse_logo.svg" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">UC Berkeley MSSE - Chem 280</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../setup.html">
    Set up
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day1.html">
    Day 1
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day2.html">
    Day 2
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../day3.html">
    Day 3
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../day4.html">
    Day 4
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../day5.html">
    Day 5
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../day6.html">
    Day 6
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../day7.html">
    Day 7
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../day8.html">
    Day 8
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../day9.html">
    Day 9
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../individual-assignments.html">
    Individual Assignments
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../final-project.html">
    Final Project Assignment
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://msse.berkeley.edu/">
    MSSE
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://msse-chem-280-2023.github.io/git-cheat-sheet/">
    Git Cheat Sheet
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://www.nist.gov/mml/csd/chemical-informatics-group/lennard-jones-fluid-reference-calculations-cuboid-cell">
    NIST LJ Reference
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-external" href="https://mmlapps.nist.gov/srs/LJ_PURE/mc.htm">
    NIST MC Isotherms
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/jchen0506/molssi_doc_theme" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/MolSSI_NSF" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../setup.html">
    Set up
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day1.html">
    Day 1
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day2.html">
    Day 2
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../day3.html">
    Day 3
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day4.html">
    Day 4
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day5.html">
    Day 5
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day6.html">
    Day 6
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day7.html">
    Day 7
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day8.html">
    Day 8
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../day9.html">
    Day 9
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../individual-assignments.html">
    Individual Assignments
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../final-project.html">
    Final Project Assignment
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://msse.berkeley.edu/">
    MSSE
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://msse-chem-280-2023.github.io/git-cheat-sheet/">
    Git Cheat Sheet
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://www.nist.gov/mml/csd/chemical-informatics-group/lennard-jones-fluid-reference-calculations-cuboid-cell">
    NIST LJ Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://mmlapps.nist.gov/srs/LJ_PURE/mc.htm">
    NIST MC Isotherms
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/jchen0506/molssi_doc_theme" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/MolSSI_NSF" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00-group-meeting.html">Python Warm Up &amp; Returning to the LJ Equation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Lennard Jones Energy of Atomic System</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-computational-tricks.html">Cut-offs and Periodic Boundaries</a></li>
</ul>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../individual-assignments/individual-assignment-1.html">Individual Homework Assignment 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="group-assignment.html">Group Homework Assignment Day 3</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../day3.html" class="nav-link">Day 3</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Lennard...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="lennard-jones-energy-of-atomic-system">
<h1>Lennard Jones Energy of Atomic System<a class="headerlink" href="#lennard-jones-energy-of-atomic-system" title="Link to this heading">#</a></h1>
<div class="overview admonition">
<p class="admonition-title">Overview</p>
<p>Questions:</p>
<ul class="simple">
<li><p>How do I use the Lennard Jones equation to calculate the energy of an atomic system?</p></li>
</ul>
<p>Objectives:</p>
<ul class="simple">
<li><p>Write Python code to calculate the Lennard Jones energy.</p></li>
</ul>
</div>
<div class="tip admonition">
<p class="admonition-title">Getting the required functions</p>
<p>To continue with this lesson, make sure you have your Lennard Jones function (<code class="docutils literal notranslate"><span class="pre">calculate_LJ</span></code>) in reduced units, and your <code class="docutils literal notranslate"><span class="pre">calculate_distance</span></code> function (written as a homework assignment.).
In your Jupyter notebook.</p>
</div>
<p>When applying the LJ potential to a set of atomic coordinates, the total potential energy of the system is equal to the sum of the LJ energy over all pairwise interactions:</p>
<div class="math notranslate nohighlight">
\[
U \left( \textbf{r}^N \right) = \sum_{i=1}^{N} \sum_{j&gt;i}^{N} U \left( r_{ij} \right)
\]</div>
<p>We can write some steps out for calculating the total Lennard Jones potential energy for a system.</p>
<ol class="arabic simple">
<li><p>Calculate the distance between each particle and every other particle in the system.</p></li>
<li><p>Evaluate the Lennard Jones potential for each distance</p></li>
<li><p>Sum the energies to get the total potential energy.</p></li>
</ol>
<p>From this procedure, we can see that we will need a few more functions.
We will need a function that can calculate a distance between two particles based on their coordinates. We will need to loop over particle pairs.</p>
<section id="calculating-the-total-pairwise-lj-energy">
<h2>Calculating the total pairwise LJ energy<a class="headerlink" href="#calculating-the-total-pairwise-lj-energy" title="Link to this heading">#</a></h2>
<p>Next, we will write a function for calculating the total pair potential energy of a system of particles. Using the equation above, we can write the function:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-0">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_total_energy</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the total Lennard Jones energy of a system of particles.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    coordinates : list</span>
<span class="sd">        Nested list containing particle coordinates.</span>
<span class="sd">    </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    total_energy : float</span>
<span class="sd">        the total pairwise Lennard Jones energy</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">total_energy</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">num_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_atoms</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_atoms</span><span class="p">):</span>
            <span class="n">dist_ij</span> <span class="o">=</span> <span class="n">calculate_distance</span><span class="p">(</span><span class="n">coordinates</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">coordinates</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
            <span class="n">total_energy</span> <span class="o">+=</span> <span class="n">calculate_LJ</span><span class="p">(</span><span class="n">dist_ij</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">total_energy</span>
</pre></div>
</div>
</div>
</div>
<p>In order to test this, let’s create a system where we roughly know the energy. We will want a system of more than two particles, otherwise we are just testing the <code class="docutils literal notranslate"><span class="pre">calculate_LJ</span></code> function. We will have three particles which are spaced by a distance of <span class="math notranslate nohighlight">\(2^{1/6}\sigma\)</span>. We would expect this system of particles to have an energy of roughly <span class="math notranslate nohighlight">\(-2\epsilon\)</span>.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-1" name="sd-tab-set-1" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-1">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="mi">0</span><span class="p">]]</span>

<span class="n">test_energy</span> <span class="o">=</span> <span class="n">calculate_total_energy</span><span class="p">(</span><span class="n">coordinates</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">test_energy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-2" name="sd-tab-set-2" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="output" for="sd-tab-item-2">
OUTPUT</label><div class="sd-tab-content docutils">
<div class="highlight-output notranslate"><div class="highlight"><pre><span></span><span class="go">-2.031005859375</span>
</pre></div>
</div>
</div>
</div>
<p>This seems promising. The additional <code class="docutils literal notranslate"><span class="pre">0.031</span></code> is from the interaction of particles 1 and 3. The assert statement for this check will be a little different. We can use the function <code class="docutils literal notranslate"><span class="pre">math.isclose</span></code> to compare two numbers within a certain tolerance. If the numbers are close, <code class="docutils literal notranslate"><span class="pre">True</span></code> is returned, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>We can write our assert statement to check that the two values are within 5% of one another</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-3" name="sd-tab-set-3" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-3">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">assert</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">test_energy</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">rel_tol</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="reading-coordinates-from-nist-file">
<h3>Reading coordinates from NIST file<a class="headerlink" href="#reading-coordinates-from-nist-file" title="Link to this heading">#</a></h3>
<p>Now that we have functions for calculating the LJ energy for a system of particles, we can compare our calculated values to those reported by NIST. Use the provided <code class="docutils literal notranslate"><span class="pre">read_xyz</span></code> function below to read coordinates from the provided sample coordinate files:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-4" name="sd-tab-set-4" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-4">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_xyz</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads coordinates from an xyz file.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filepath : str</span>
<span class="sd">       The path to the xyz file to be processed.</span>
<span class="sd">       </span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    atomic_coordinates : list</span>
<span class="sd">        A two dimensional list containing atomic coordinates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">box_length</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">num_atoms</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">())</span>
        <span class="n">coordinates</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    
    <span class="n">atomic_coordinates</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">:</span>
        <span class="n">split_atoms</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        
        <span class="n">float_coords</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c1"># We split this way to get rid of the atom label.</span>
        <span class="k">for</span> <span class="n">coord</span> <span class="ow">in</span> <span class="n">split_atoms</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
            <span class="n">float_coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">coord</span><span class="p">))</span>
            
        <span class="n">atomic_coordinates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">float_coords</span><span class="p">)</span>
        
    
    <span class="k">return</span> <span class="n">atomic_coordinates</span><span class="p">,</span> <span class="n">box_length</span>
</pre></div>
</div>
</div>
</div>
<p>Use the function to read in the first sample configuration:</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-5" name="sd-tab-set-5" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-5">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">config1_file</span> <span class="o">=</span> <span class="s2">&quot;../data/sample_config1.txt&quot;</span>

<span class="n">sample_coords</span><span class="p">,</span> <span class="n">box_length</span> <span class="o">=</span> <span class="n">read_xyz</span><span class="p">(</span><span class="n">config1_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sanity-checks">
<h3>Sanity Checks<a class="headerlink" href="#sanity-checks" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Check that function has expected number of coordinates.</p></li>
<li><p>Check that first line, last line is as expected.</p></li>
</ol>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-6" name="sd-tab-set-6" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-6">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># We expect this file to have 800 particles</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sample_coords</span><span class="p">)</span> <span class="o">==</span> <span class="mi">800</span>

<span class="c1"># We expect the first line to be:</span>
<span class="n">first_line</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">1.126362593256E-01</span><span class="p">,</span> <span class="mf">1.385093082507E+00</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.842035145736E-01</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">first_line</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">sample_coords</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    
<span class="c1"># We expect the last line to be:</span>
<span class="n">last_line</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.497455843197</span><span class="p">,</span> <span class="mf">0.3754925406415</span><span class="p">,</span> <span class="mf">4.393398690912</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">last_line</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="n">sample_coords</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="pairwise-lj-energy-for-nist-system">
<h3>Pairwise LJ energy for NIST system<a class="headerlink" href="#pairwise-lj-energy-for-nist-system" title="Link to this heading">#</a></h3>
<p>We will now compare our calculated total energy to reference values from NIST. You can see a list of reference values <a class="reference external" href="https://www.nist.gov/mml/csd/chemical-informatics-group/lennard-jones-fluid-reference-calculations-cuboid-cell">on this website</a>. We are using configuration 1.</p>
<p>When we try comparing our calculated energy to those reported by NIST, we will find that they are not the same. Because we’ve tested each of our functions as we’ve written them, we can be somewhat confident this isn’t occurring because of errors in our code.</p>
<p>Instead, it must be from different assumptions we are making about our system.</p>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-7" name="sd-tab-set-7" type="radio">
<label class="sd-tab-label" data-sync-group="code" data-sync-id="python" for="sd-tab-item-7">
PYTHON</label><div class="sd-tab-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">total_energy</span> <span class="o">=</span> <span class="n">calculate_total_energy</span><span class="p">(</span><span class="n">sample_coords</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">total_energy</span> <span class="o">==</span> <span class="o">-</span><span class="mf">4351.5</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-8" name="sd-tab-set-8" type="radio">
<label class="sd-tab-label" for="sd-tab-item-8">
error</label><div class="sd-tab-content docutils">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">AssertionError</span>                            <span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="n">b7c5eba717e6</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="mi">1</span> <span class="k">assert</span> <span class="n">total_energy</span> <span class="o">==</span> <span class="o">-</span><span class="mf">4351.5</span>

<span class="ne">AssertionError</span><span class="p">:</span> 
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="00-group-meeting.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Python Warm Up &amp; Returning to the LJ Equation</p>
      </div>
    </a>
    <a class="right-next"
       href="02-computational-tricks.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cut-offs and Periodic Boundaries</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-the-total-pairwise-lj-energy">Calculating the total pairwise LJ energy</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reading-coordinates-from-nist-file">Reading coordinates from NIST file</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sanity-checks">Sanity Checks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pairwise-lj-energy-for-nist-system">Pairwise LJ energy for NIST system</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../_sources/day3/01-LJ-system.md.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  



  
  
  
  
  
  
  


<div class="row h-10">
    <div class="col-2">
        <a href="https://molssi.org/" target="_blank" title="Go to MolSSI in a new tab">
            <img src="../_static/molssi_main_logo.png" class="logo__image only-light footer_logo" alt="Logo image">
            <img src="../_static/molssi_main_logo_inverted_white.png" class="logo__image only-dark footer_logo" alt="Logo image">
        </a>
    </div>
    <div class="col-8">
        <p> &copy; Copyright 2019-2023 <a href="https://molssi.org/">The Molecular Sciences Software Institute</a></p>
        <p>Funded by the National Science Foundation 
          <a href="https://nsf.gov/awardsearch/showAward?AWD_ID=1547580">OAC-1547580</a> and 
          <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=2136142">CHE-2136142.</a></p>
 
        
        <p class="sphinx-version">
        Created using <a href="http://sphinx-doc.org/">Sphinx</a> 7.3.7.<br>
        </p>
        

        <p class="theme-version">
        Built with a customized <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
        </p>

    </div>
    <div class="col-2">
        <a href="https://nsf.gov/" target="_blank" title="Go to the NSF in a new tab">
            <img src="../_static/nsf.png" class="footer_logo" alt="The NSF">
          </a>
    </div>
</div></div>
      
    </div>
  
  
  
</div>

  </footer>
  </body>
</html>